<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Đổi mật khẩu - E-Shop</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .password-card {
            max-width: 600px;
            margin: 0 auto;
        }
        
        .password-strength {
            height: 4px;
            border-radius: 2px;
            transition: all 0.3s ease;
        }
        
        .strength-0 { width: 0%; background-color: #ef4444; }
        .strength-1 { width: 25%; background-color: #ef4444; }
        .strength-2 { width: 50%; background-color: #f59e0b; }
        .strength-3 { width: 75%; background-color: #3b82f6; }
        .strength-4 { width: 100%; background-color: #10b981; }
        
        .password-toggle {
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            cursor: pointer;
            color: #6b7280;
        }
        
        .input-group {
            position: relative;
        }
        
        .password-criteria {
            transition: all 0.3s ease;
            max-height: 0;
            overflow: hidden;
        }
        
        .password-criteria.active {
            max-height: 200px;
        }
        
        .criteria-item {
            transition: all 0.3s ease;
        }
        
        .criteria-item.valid {
            color: #10b981;
        }
        
        .criteria-item.valid i {
            color: #10b981;
        }
        
        .security-indicator {
            transition: all 0.5s ease;
        }
        
        .btn-save {
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .btn-save:disabled {
            opacity: 0.7;
            cursor: not-allowed;
        }
        
        .btn-save .spinner {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #ff424f;
            opacity: 0;
            transform: translateY(100%);
            transition: all 0.3s ease;
        }
        
        .btn-save.saving .spinner {
            opacity: 1;
            transform: translateY(0);
        }
        
        .password-input {
            transition: all 0.3s ease;
        }
        
        .password-input:focus {
            box-shadow: 0 0 0 3px rgba(66, 153, 225, 0.2);
        }
        
        .success-message {
            max-height: 0;
            overflow: hidden;
            transition: all 0.5s ease;
        }
        
        .success-message.active {
            max-height: 200px;
        }
        
        .error-message {
            color: #ef4444;
            font-size: 0.875rem;
            margin-top: 0.25rem;
            max-height: 0;
            overflow: hidden;
            transition: all 0.3s ease;
        }
        
        .error-message.active {
            max-height: 50px;
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen flex items-center">
    <div class="container mx-auto px-4 py-8">
        <div class="password-card bg-white rounded-xl shadow-lg p-6 md:p-8">
            <!-- Header -->
            <div class="text-center mb-8">
                <div class="mx-auto w-16 h-16 rounded-full bg-red-100 flex items-center justify-center mb-4">
                    <i class="fas fa-lock text-2xl text-red-600"></i>
                </div>
                <h1 class="text-2xl font-bold text-gray-800 mb-2">Đổi mật khẩu</h1>
                <p class="text-gray-600">Bảo vệ tài khoản của bạn bằng mật khẩu mới an toàn</p>
            </div>
            
            <!-- Success Message (hidden by default) -->
            <div id="success-message" class="success-message bg-green-50 text-green-800 p-4 rounded-lg mb-6">
                <div class="flex items-center">
                    <i class="fas fa-check-circle text-xl mr-3"></i>
                    <div>
                        <h3 class="font-bold">Đổi mật khẩu thành công!</h3>
                        <p>Mật khẩu của bạn đã được cập nhật. Vui lòng đăng nhập lại với mật khẩu mới.</p>
                    </div>
                </div>
            </div>
            
            <!-- Password Form -->
            <form id="password-form">
                <div class="space-y-5">
                    <!-- Current Password -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Mật khẩu hiện tại</label>
                        <div class="input-group">
                            <input type="password" id="current-password" class="password-input w-full p-3 border rounded-lg" required>
                            <span class="password-toggle" id="toggle-current-password">
                                <i class="far fa-eye"></i>
                            </span>
                        </div>
                        <div id="current-password-error" class="error-message"></div>
                    </div>
                    
                    <!-- New Password -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Mật khẩu mới</label>
                        <div class="input-group">
                            <input type="password" id="new-password" class="password-input w-full p-3 border rounded-lg" required>
                            <span class="password-toggle" id="toggle-new-password">
                                <i class="far fa-eye"></i>
                            </span>
                        </div>
                        <div class="mt-2">
                            <div class="flex justify-between text-xs text-gray-500 mb-1">
                                <span>Độ mạnh mật khẩu</span>
                                <span id="password-strength-text">Rất yếu</span>
                            </div>
                            <div class="password-strength strength-0" id="password-strength-bar"></div>
                        </div>
                        <div id="new-password-error" class="error-message"></div>
                        
                        <!-- Password Criteria -->
                        <div class="password-criteria mt-4" id="password-criteria">
                            <p class="text-sm font-medium text-gray-700 mb-2">Mật khẩu của bạn cần:</p>
                            <ul class="space-y-2 text-sm">
                                <li class="criteria-item" id="criteria-length">
                                    <i class="fas fa-circle text-gray-300 mr-2 text-xs"></i>
                                    Ít nhất 8 ký tự
                                </li>
                                <li class="criteria-item" id="criteria-uppercase">
                                    <i class="fas fa-circle text-gray-300 mr-2 text-xs"></i>
                                    Chứa chữ cái in hoa (A-Z)
                                </li>
                                <li class="criteria-item" id="criteria-number">
                                    <i class="fas fa-circle text-gray-300 mr-2 text-xs"></i>
                                    Chứa số (0-9)
                                </li>
                                <li class="criteria-item" id="criteria-special">
                                    <i class="fas fa-circle text-gray-300 mr-2 text-xs"></i>
                                    Chứa ký tự đặc biệt (!@#$%^&*)
                                </li>
                            </ul>
                        </div>
                    </div>
                    
                    <!-- Confirm Password -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Xác nhận mật khẩu mới</label>
                        <div class="input-group">
                            <input type="password" id="confirm-password" class="password-input w-full p-3 border rounded-lg" required>
                            <span class="password-toggle" id="toggle-confirm-password">
                                <i class="far fa-eye"></i>
                            </span>
                        </div>
                        <div id="confirm-password-error" class="error-message"></div>
                    </div>
                    
                    <!-- Security Indicator -->
                    <div class="security-indicator bg-blue-50 border border-blue-200 rounded-lg p-4">
                        <div class="flex items-start">
                            <i class="fas fa-shield-alt text-blue-500 text-xl mr-3 mt-1"></i>
                            <div>
                                <h3 class="font-medium text-blue-800">Bảo mật tài khoản</h3>
                                <p class="text-blue-700 text-sm mt-1">Mật khẩu mạnh giúp bảo vệ tài khoản của bạn khỏi các nguy cơ bảo mật. Vui lòng không sử dụng mật khẩu cũ.</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Submit Button -->
                    <button type="submit" id="save-btn" class="btn-save w-full py-3 bg-red-600 text-white rounded-lg hover:bg-red-700 font-medium relative">
                        <span>Đổi mật khẩu</span>
                        <div class="spinner">
                            <i class="fas fa-spinner fa-spin"></i>
                        </div>
                    </button>
                </div>
            </form>
            
            <!-- Additional Options -->
            <div class="mt-6 pt-6 border-t border-gray-200 text-center">
                <a href="#" class="text-blue-600 hover:text-blue-800">
                    <i class="fas fa-key mr-1"></i> Quên mật khẩu?
                </a>
            </div>
        </div>
    </div>

    <script>
        // DOM Elements
        const passwordForm = document.getElementById('password-form');
        const currentPasswordInput = document.getElementById('current-password');
        const newPasswordInput = document.getElementById('new-password');
        const confirmPasswordInput = document.getElementById('confirm-password');
        const passwordStrengthBar = document.getElementById('password-strength-bar');
        const passwordStrengthText = document.getElementById('password-strength-text');
        const passwordCriteria = document.getElementById('password-criteria');
        const saveBtn = document.getElementById('save-btn');
        const successMessage = document.getElementById('success-message');
        
        // Password toggle elements
        const toggleCurrentPassword = document.getElementById('toggle-current-password');
        const toggleNewPassword = document.getElementById('toggle-new-password');
        const toggleConfirmPassword = document.getElementById('toggle-confirm-password');
        
        // Error elements
        const currentPasswordError = document.getElementById('current-password-error');
        const newPasswordError = document.getElementById('new-password-error');
        const confirmPasswordError = document.getElementById('confirm-password-error');
        
        // Criteria elements
        const criteriaLength = document.getElementById('criteria-length');
        const criteriaUppercase = document.getElementById('criteria-uppercase');
        const criteriaNumber = document.getElementById('criteria-number');
        const criteriaSpecial = document.getElementById('criteria-special');
        
        // Password strength levels
        const strengthLevels = [
            { text: "Rất yếu", class: "strength-0" },
            { text: "Yếu", class: "strength-1" },
            { text: "Trung bình", class: "strength-2" },
            { text: "Mạnh", class: "strength-3" },
            { text: "Rất mạnh", class: "strength-4" }
        ];
        
        // Toggle password visibility
        function togglePasswordVisibility(inputElement, toggleElement) {
            const type = inputElement.getAttribute('type') === 'password' ? 'text' : 'password';
            inputElement.setAttribute('type', type);
            
            const icon = toggleElement.querySelector('i');
            icon.classList.toggle('fa-eye');
            icon.classList.toggle('fa-eye-slash');
        }
        
        // Validate password strength
        function checkPasswordStrength(password) {
            let strength = 0;
            
            // Criteria flags
            let hasLength = false;
            let hasUppercase = false;
            let hasNumber = false;
            let hasSpecial = false;
            
            // Check password length
            if (password.length >= 8) {
                strength += 1;
                hasLength = true;
            }
            
            // Check for uppercase letters
            if (/[A-Z]/.test(password)) {
                strength += 1;
                hasUppercase = true;
            }
            
            // Check for numbers
            if (/\d/.test(password)) {
                strength += 1;
                hasNumber = true;
            }
            
            // Check for special characters
            if (/[!@#$%^&*]/.test(password)) {
                strength += 1;
                hasSpecial = true;
            }
            
            // Update criteria indicators
            criteriaLength.classList.toggle('valid', hasLength);
            criteriaUppercase.classList.toggle('valid', hasUppercase);
            criteriaNumber.classList.toggle('valid', hasNumber);
            criteriaSpecial.classList.toggle('valid', hasSpecial);
            
            return strength;
        }
        
        // Update password strength indicator
        function updatePasswordStrength() {
            const password = newPasswordInput.value;
            
            if (password.length === 0) {
                passwordStrengthBar.className = 'password-strength strength-0';
                passwordStrengthText.textContent = '';
                passwordCriteria.classList.remove('active');
                return;
            }
            
            passwordCriteria.classList.add('active');
            const strength = checkPasswordStrength(password);
            passwordStrengthBar.className = `password-strength ${strengthLevels[strength].class}`;
            passwordStrengthText.textContent = strengthLevels[strength].text;
            passwordStrengthText.style.color = getComputedStyle(passwordStrengthBar).backgroundColor;
        }
        
        // Validate form
        function validateForm() {
            let isValid = true;
            
            // Reset errors
            currentPasswordError.textContent = '';
            currentPasswordError.classList.remove('active');
            newPasswordError.textContent = '';
            newPasswordError.classList.remove('active');
            confirmPasswordError.textContent = '';
            confirmPasswordError.classList.remove('active');
            
            const currentPassword = currentPasswordInput.value;
            const newPassword = newPasswordInput.value;
            const confirmPassword = confirmPasswordInput.value;
            
            // Validate current password
            if (!currentPassword) {
                currentPasswordError.textContent = 'Vui lòng nhập mật khẩu hiện tại';
                currentPasswordError.classList.add('active');
                isValid = false;
            } else if (currentPassword.length < 6) {
                currentPasswordError.textContent = 'Mật khẩu phải có ít nhất 6 ký tự';
                currentPasswordError.classList.add('active');
                isValid = false;
            }
            
            // Validate new password
            if (!newPassword) {
                newPasswordError.textContent = 'Vui lòng nhập mật khẩu mới';
                newPasswordError.classList.add('active');
                isValid = false;
            } else {
                const strength = checkPasswordStrength(newPassword);
                
                if (strength < 3) {
                    newPasswordError.textContent = 'Mật khẩu quá yếu. Vui lòng tạo mật khẩu mạnh hơn';
                    newPasswordError.classList.add('active');
                    isValid = false;
                }
                
                // Check if new password is same as current
                if (currentPassword && newPassword === currentPassword) {
                    newPasswordError.textContent = 'Mật khẩu mới phải khác mật khẩu hiện tại';
                    newPasswordError.classList.add('active');
                    isValid = false;
                }
            }
            
            // Validate confirm password
            if (!confirmPassword) {
                confirmPasswordError.textContent = 'Vui lòng xác nhận mật khẩu mới';
                confirmPasswordError.classList.add('active');
                isValid = false;
            } else if (newPassword !== confirmPassword) {
                confirmPasswordError.textContent = 'Mật khẩu xác nhận không khớp';
                confirmPasswordError.classList.add('active');
                isValid = false;
            }
            
            return isValid;
        }
        
        // Show success message
        function showSuccessMessage() {
            successMessage.classList.add('active');
            passwordForm.reset();
            
            // Reset password strength indicator
            passwordStrengthBar.className = 'password-strength strength-0';
            passwordStrengthText.textContent = '';
            passwordCriteria.classList.remove('active');
            
            // Reset criteria indicators
            criteriaLength.classList.remove('valid');
            criteriaUppercase.classList.remove('valid');
            criteriaNumber.classList.remove('valid');
            criteriaSpecial.classList.remove('valid');
            
            // Hide success message after 5 seconds
            setTimeout(() => {
                successMessage.classList.remove('active');
            }, 5000);
        }
        
        // Handle form submission
        function handleSubmit(e) {
            e.preventDefault();
            
            if (!validateForm()) {
                return;
            }
            
            // Show saving state
            saveBtn.disabled = true;
            saveBtn.classList.add('saving');
            
            // Simulate API call to change password
            setTimeout(() => {
                // Hide saving state
                saveBtn.disabled = false;
                saveBtn.classList.remove('saving');
                
                // Show success message
                showSuccessMessage();
                
                // In a real app, you would redirect or show a success message
                console.log('Password changed successfully');
            }, 2000);
        }
        
        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', () => {
            // Password toggle event listeners
            toggleCurrentPassword.addEventListener('click', () => {
                togglePasswordVisibility(currentPasswordInput, toggleCurrentPassword);
            });
            
            toggleNewPassword.addEventListener('click', () => {
                togglePasswordVisibility(newPasswordInput, toggleNewPassword);
            });
            
            toggleConfirmPassword.addEventListener('click', () => {
                togglePasswordVisibility(confirmPasswordInput, toggleConfirmPassword);
            });
            
            // Password strength updates
            newPasswordInput.addEventListener('input', updatePasswordStrength);
            
            // Form submission
            passwordForm.addEventListener('submit', handleSubmit);
        });
    </script>
</body>
</html>